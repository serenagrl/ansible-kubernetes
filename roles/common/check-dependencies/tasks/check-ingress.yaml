# Author: Serena Yeoh
# Co-Author: Jaryl Lan
#
# Disclaimer:
# This playbook was written based on my self-learning and may not follow certain
# best practices or work properly in your environment. Use it at your own risk.
#

- name: Check ingress is installed
  block:
    - name: Check ingress is installed
      vars:
        services:
          contour: get-httpproxy.yaml
          nginx: get-ingress-class.yaml
        ingress: "{{ services[kube.ingress_type] }}"
      ansible.builtin.include_tasks: "{{ services[kube.ingress_type] }}"

    - ansible.builtin.set_fact:
        fact_has_addons_ingress: "{{ ingress_result.resources | length > 0 }}"