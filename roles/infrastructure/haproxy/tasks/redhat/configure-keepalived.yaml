# Author: Serena Yeoh
# Co-Author: Jaryl Lan
#
# Disclaimer:
# This playbook was written based on my self-learning and may not follow certain
# best practices or work properly in your environment. Use it at your own risk.
#
- name: Configure keepalived
  become_user: root
  block:
    - name: Remove default keepalived configuration file
      ansible.builtin.file:
        path: /etc/keepalived/keepalived.conf
        state: absent

    - name: Configure virtual ip address for keepalived
      ansible.builtin.blockinfile:
        create: yes
        path: /etc/keepalived/keepalived.conf
        block: |
          {{ KEEPALIVED_CONFIG_TEMPLATE }}