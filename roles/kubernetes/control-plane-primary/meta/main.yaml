dependencies:
  - role: kubernetes/cluster-node

  - role: infrastructure/dns/register
    server_name: "{{ _kube.cluster.name }}"
    server_ip: "{{ _kube.cluster.address }}"
    when: _kube.cluster.use_dns_server

  - role: infrastructure/haproxy/register
    in_backend_port: 6443
    in_backend_name: "{{ _kube.cluster.name }}-apiserver"
    when: register_to_load_balancer