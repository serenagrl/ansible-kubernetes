- name: Provision Virtual Machines
  hosts: kubernetes_cluster
  gather_facts: no

  pre_tasks:
    - name: Create working directory
      delegate_to: localhost
      become_user: root
      file:
        path: "{{ _work_dir }}"
        state: directory
      run_once: yes

  roles:
    - vm-ubuntu

  # Create checkpoints for safety reasons. You can delete the checkpoints later.
- import_playbook: checkpoint-vm.yaml
  vars:
    checkpoint_name: "Ubuntu configured."
  when: _checkpoint
