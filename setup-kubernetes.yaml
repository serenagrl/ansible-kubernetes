# Configure primary control plane
- name: Create primary control plane
  hosts: primary_control_plane[0]
  gather_facts: no

  roles:
    - kube-control-plane-primary
    - cni-calico

# Configure sencondary control planes
- name: Join secondary control planes
  hosts: secondary_control_planes
  gather_facts: no

  roles:
    - kube-control-plane-other

# Uncomment this to have worker nodes.
# - name: Join worker nodes
#   hosts: kubernetes_nodes
#   gather_facts: no

#   roles:
#     - kube-worker

  # Create checkpoints for safety reasons. You can delete the checkpoints later.
- import_playbook: checkpoint-vm.yaml
  vars:
    checkpoint_name: "Kubernetes configured."
  when: _checkpoint